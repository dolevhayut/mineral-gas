# מדריך למנהל: הגדרת ימי אספקה

## סקירה כללית
מערכת ימי האספקה מאפשרת לך להגדיר לכל יום עבודה (ראשון-שישי) אילו יישובים יקבלו אספקה. הלקוחות יראו רק את הימים שבהם היישוב שלהם זמין לאספקה.

**שעות פעילות**: אספקות מתבצעות בימים ראשון עד שישי בלבד, בין השעות 08:00-16:00. אין אספקות בשבת.

**חשוב לדעת**: רשימת היישובים נטענת אוטומטית מה-API הממשלתי של data.gov.il (יישובי הצפון בלבד). אין צורך לנהל רשימת יישובים באופן ידני.

## שלבי ההתקנה הראשונית

### שלב 1: יצירת טבלת המסד נתונים
1. היכנס ל-Supabase Dashboard
2. עבור ל-SQL Editor
3. העתק והדבק את התוכן מהקובץ `sql/create_delivery_days_table.sql`
4. הרץ את הסקריפט
5. וודא שהטבלה `delivery_days` נוצרה בהצלחה

### שלב 2: הגדרת ימי האספקה
1. היכנס לפאנל הניהול
2. לחץ על "ימי אספקה" בתפריט הצד
3. תראה 7 כרטיסיות - אחת לכל יום בשבוע
4. לכל יום, בחר את הערים שיקבלו אספקה באותו יום
5. לחץ על "שמור הגדרות" כדי לשמור את השינויים

## דוגמת הגדרה

```
יום ראשון: חיפה, קריית מוצקין, קריית ביאליק
יום שני: עכו, נהריה, כרמיאל
יום שלישי: צפת, טבריה, קריית שמונה
יום רביעי: מעלות, טמרה, שפרעם
יום חמישי: סחנין, מגאר, ירכא
יום שישי: כפר יאסיף, ג'וליס, ג'דיידה
שבת: אין אספקות (יום מנוחה)
```

## חוקי המערכת

### כללי בסיסיים
- **לקוח לא יכול לבחור את היום הנוכחי** - אם היום יום ראשון, הלקוח לא יוכל לבחור יום ראשון
- **המערכת מחשבת אוטומטית את התאריך** - כשלקוח בוחר יום, המערכת מחשבת את המופע הבא של אותו יום
- **הלקוח רואה רק ימים רלוונטיים** - לקוח מתל אביב יראה רק ימים שבהם תל אביב מוגדרת

### דוגמאות
1. **היום יום ראשון, לקוח בוחר יום שלישי**
   - תאריך האספקה: יום שלישי הקרוב (בעוד יומיים)

2. **היום יום ראשון, לקוח מנסה לבחור יום ראשון**
   - המערכת לא תציג את יום ראשון כאפשרות
   - הלקוח יצטרך לבחור יום אחר

3. **לקוח מירושלים**
   - אם הגדרת שירושלים מקבלת אספקה רק ביום שני
   - הלקוח יראה רק את יום שני כאפשרות

## ניהול שוטף

### הוספת עיר חדשה
1. וודא שלקוח קיים עם העיר החדשה במערכת
2. היכנס לעמוד "ימי אספקה"
3. בחר את הימים שבהם העיר החדשה תקבל אספקה
4. סמן את העיר בכל יום רלוונטי
5. שמור את ההגדרות

### הסרת עיר מיום מסוים
1. היכנס לעמוד "ימי אספקה"
2. מצא את היום שממנו תרצה להסיר את העיר
3. בטל את הסימון של העיר
4. שמור את ההגדרות
5. **שים לב**: לקוחות מאותה עיר לא יוכלו יותר לבחור את היום הזה

### שינוי תצורה קיימת
1. השינויים נכנסים לתוקף מיד לאחר השמירה
2. לקוחות שכבר ביצעו הזמנות לא יושפעו
3. הזמנות חדשות יתבססו על התצורה החדשה

## פתרון בעיות נפוצות

### לקוח לא רואה ימי אספקה
**בעיה**: לקוח רואה הודעה "אין ימי משלוח זמינים"

**פתרון**:
1. בדוק שהעיר של הלקוח מוגדרת בפרופיל שלו
2. בדוק שהעיר מופיעה בהגדרות ימי האספקה לפחות ליום אחד
3. בדוק שהטבלה `delivery_days` במסד הנתונים מכילה נתונים

### יישוב לא מופיע ברשימה
**בעיה**: יישוב חדש לא מופיע באפשרויות

**פתרון**:
1. רענן את הדף - היישובים נטענים מ-API ממשלתי
2. וודא שהיישוב שייך לאחד ממחוזות הצפון: עכו, יזרעאל, צפת, כנרת, גולן, חיפה
3. אם היישוב לא ממחוז הצפון, הוא לא יופיע (כי המערכת מסננת רק יישובי צפון)
4. בדוק את החיבור לאינטרנט - ללא חיבור לא ניתן לטעון יישובים

### שגיאה בשמירת הגדרות
**בעיה**: הודעת שגיאה בעת שמירה

**פתרון**:
1. בדוק את החיבור לאינטרנט
2. וודא שאתה מחובר כמנהל
3. בדוק את הקונסול בדפדפן לשגיאות
4. בדוק הרשאות ב-Supabase

## טיפים לשימוש יעיל

### ארגון לפי אזורים
```
יום ראשון: מרכז (תל אביב, חולון, בת ים, רמת גן)
יום שני: ירושלים והסביבה
יום שלישי: צפון (חיפה, קריות, נצרת)
יום רביעי: שפלה (רחובות, נס ציונה, ראשון לציון)
יום חמישי: דרום (באר שבע, אשקלון, אשדוד)
```

### אופטימיזציה של מסלולים
1. קבץ ערים קרובות באותו יום
2. התאם לגודל הצוות שלך
3. התחשב בזמני נסיעה בין ערים
4. שמור יום אחד לחירום או התאמות

### תכנון מראש
1. הכן תצורה לחגים מראש
2. שמור גיבוי של התצורה הנוכחית
3. הודע ללקוחות על שינויים בזמנים
4. בדוק מדי פעם את האפקטיביות של התצורה

## שאלות נפוצות

**ש: האם אפשר לשנות את ההגדרות באמצע היום?**
ת: כן, אבל זה ישפיע רק על הזמנות חדשות. הזמנות שכבר בוצעו לא ישתנו.

**ש: מה קורה אם לקוח עובר לעיר אחרת?**
ת: כשהלקוח מעדכן את העיר בפרופיל שלו, הוא אוטומטית יראה את ימי האספקה של העיר החדשה.

**ש: האם חובה להגדיר את כל 7 הימים?**
ת: לא. אפשר להשאיר ימים ללא הגדרה. באותם ימים פשוט לא תהיה אספקה.

**ש: מה עדיף - הרבה ימים למעט ערים או מעט ימים להרבה ערים?**
ת: תלוי בגודל הצוות ובפיזור הלקוחות. מומלץ להתחיל עם פחות ימים ולהרחיב בהדרגה.

**ש: איך אפשר לעקוב אחרי ההזמנות לפי יום?**
ת: בעמוד "הזמנות" תוכל לסנן לפי תאריך אספקה ולראות את כל ההזמנות ליום מסוים.

## תמיכה נוספת

במקרה של בעיות:
1. בדוק את מסמך `DELIVERY_DAYS_IMPLEMENTATION.md` למידע טכני מפורט
2. בדוק את הקונסול בדפדפן לשגיאות
3. בדוק את הלוגים ב-Supabase
4. צור קשר עם התמיכה הטכנית

---

**עודכן לאחרונה**: נובמבר 2024

